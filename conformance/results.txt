--- Running conformance test v1.0 on /usr/local/bin/calrissian ---
calrissian 0.6.0 (cwltool 1.0.20181217162649)
Test [1/108] General test of command line generation

Test [2/108] Test nested prefixes with arrays

Test [3/108] Test nested command line bindings

Test [4/108] Test command line with optional input (missing)

Test [5/108] Test command line with optional input (provided)

Test [6/108] Test InitialWorkDirRequirement ExpressionEngineRequirement.engineConfig feature

Test [7/108] Test command execution in Docker with stdout redirection

Test [8/108] Test command execution in Docker with simplified syntax stdout redirection

Test [9/108] Test command execution in Docker with stdout redirection

Test [10/108] Test command line with stderr redirection

Test [11/108] Test command line with stderr redirection, brief syntax

Test [12/108] Test command line with stderr redirection, named brief syntax

Test [13/108] Test command execution in Docker with stdin and stdout redirection

Test [14/108] Test default usage of Any in expressions.

Test [15/108] Test explicitly passing null to Any type inputs with default values.

Test [16/108] Testing the string 'null' does not trip up an Any with a default value.

Test [17/108] Testing the string 'null' does not trip up an Any without a default value.

Test [18/108] Test command execution in with stdin and stdout redirection

Test [19/108] Test ExpressionTool with Docker-based expression engine

Test [20/108] Test outputEval to transform output

Test [21/108] Test two step workflow with imported tools

Test [22/108] Test two step workflow with inline tools

Test [23/108] Test single step workflow with Scatter step

Test [24/108] Test single step workflow with Scatter step and two data links connected to
same input, default merge behavior


Test [25/108] Test single step workflow with Scatter step and two data links connected to
same input, nested merge behavior


Test [26/108] Test single step workflow with Scatter step and two data links connected to
same input, flattened merge behavior


Test [27/108] Test workflow with default value for input parameter (missing)

Test [28/108] Test workflow with default value for input parameter (provided)

Test [29/108] Test EnvVarRequirement

Test [30/108] Test workflow scatter with single scatter parameter

Test [31/108] Test workflow scatter with two scatter parameters and nested_crossproduct join method

Test [32/108] Test workflow scatter with two scatter parameters and flat_crossproduct join method

Test [33/108] Test workflow scatter with two scatter parameters and dotproduct join method

Test [34/108] Test workflow scatter with single empty list parameter

Test [35/108] Test workflow scatter with two scatter parameters and nested_crossproduct join method with second list empty

Test [36/108] Test workflow scatter with two scatter parameters and nested_crossproduct join method with first list empty

Test [37/108] Test workflow scatter with two scatter parameters, one of which is empty and flat_crossproduct join method

Test [38/108] Test workflow scatter with two empty scatter parameters and dotproduct join method

Test [39/108] Test Any type input parameter

Test [40/108] Test nested workflow

Test [41/108] Test requirement priority

Test [42/108] Test requirements override hints

Test [43/108] Test requirements on workflow steps

Test [44/108] Test default value on step input parameter

Test [45/108] Test use default value on step input parameter with empty source

Test [46/108] Test use default value on step input parameter with null source

Test [47/108] Test default value on step input parameter overridden by provided source

Test [48/108] Test simple workflow

Test [49/108] Test unknown hints are ignored.

Test [50/108] Test InitialWorkDirRequirement linking input files and capturing secondaryFiles
on input and output.


Test 50 failed: /usr/local/bin/calrissian --max-ram 8G --max-cores 4 --default-container debian:stretch-slim --outdir=/output/tmpk1c0xj52 --quiet 'v1.0/search.cwl#main' v1.0/search-job.json
Test InitialWorkDirRequirement linking input files and capturing secondaryFiles
on input and output.

Returned non-zero
Exception on step 'search'
[step search] Cannot make job: Missing required secondary file '/conformance/common-workflow-language-1.0.1/v1.0/v1.0/whale.txt.idx3' from file object: {
    "location": "/conformance/common-workflow-language-1.0.1/v1.0/v1.0/whale.txt",
    "basename": "input.txt",
    "nameroot": "input",
    "nameext": ".txt",
    "class": "File",
    "checksum": "sha1$327fc7aedf4f6b69a42a7c8b808dc5a7aff61376",
    "size": 1111,
    "secondaryFiles": [
        {
            "basename": "input.txt.idx1",
            "location": "file:///output/nmcaib3y/input.txt.idx1",
            "class": "File",
            "nameroot": "input.txt",
            "nameext": ".idx1",
            "checksum": "sha1$553f3a09003a9f69623f03bec13c0b078d706023",
            "size": 1500,
            "http://commonwl.org/cwltool#generation": 0
        },
        {
            "basename": "input.idx2",
            "location": "file:///output/nmcaib3y/input.idx2",
            "class": "File",
            "nameroot": "input",
            "nameext": ".idx2",
            "checksum": "sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709",
            "size": 0,
            "http://commonwl.org/cwltool#generation": 0
        },
        {
            "location": "file:///output/nmcaib3y/input.txt.idx4",
            "class": "File",
            "basename": "input.txt.idx4",
            "nameroot": "input.txt",
            "nameext": ".idx4",
            "checksum": "sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709",
            "size": 0,
            "http://commonwl.org/cwltool#generation": 0
        }
    ],
    "http://commonwl.org/cwltool#generation": 0
}
Final process status is permanentFail

Test [51/108] Test InitialWorkDirRequirement with expression in filename.


Test [52/108] Test inline expressions


Test [53/108] Test SchemaDefRequirement definition used in tool parameter


Test [54/108] Test SchemaDefRequirement definition used in workflow parameter


Test [55/108] Test parameter evaluation, no support for JS expressions


Test [56/108] Test parameter evaluation, with support for JS expressions


Test [57/108] Test metadata

Test [58/108] Test simple format checking.


Test [59/108] Test format checking against ontology using subclassOf.


Test [60/108] Test format checking against ontology using equivalentClass.


Test [61/108] Test optional output file and optional secondaryFile on output.


Test [62/108] Test valueFrom on workflow step.

Test [63/108] Test valueFrom on workflow step with multiple sources

Test [64/108] Test valueFrom on workflow step referencing other inputs

Test [65/108] Test record type output binding.

Test [66/108] Test support for reading cwl.output.json when running in a Docker container
and just 'path' is provided.


Test [67/108] Test support for reading cwl.output.json when running in a Docker container
and just 'location' is provided.


Test [68/108] Test support for returning multiple glob patterns from expression

Test [69/108] Test workflow scatter with single scatter parameter and valueFrom on step input

Test [70/108] Test workflow scatter with two scatter parameters and nested_crossproduct join method and valueFrom on step input

Test [71/108] Test workflow scatter with two scatter parameters and flat_crossproduct join method and valueFrom on step input

Test [72/108] Test workflow scatter with two scatter parameters and dotproduct join method and valueFrom on step input

Test [73/108] Test workflow scatter with single scatter parameter and valueFrom on step input

Test [74/108] Test workflow two input files with same name.

Test [75/108] Test directory input with parameter reference

Test [76/108] Test directory input in Docker

Test [77/108] Test directory input in Docker

Test [78/108] Test directories in secondaryFiles

Test [79/108] Test dynamic initial work dir

Test [80/108] Test writable staged files.

Test [81/108] Test file literal as input

Test 81 failed: /usr/local/bin/calrissian --max-ram 8G --max-cores 4 --default-container debian:stretch-slim --outdir=/output/tmpd258z5ip --quiet v1.0/cat3-tool.cwl v1.0/file-literal.yml
Test file literal as input
Returned non-zero
Got workflow error
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/cwltool/executors.py", line 264, in runner
    job.run(runtime_context)
  File "/usr/local/lib/python3.6/site-packages/calrissian/job.py", line 557, in run
    pod = self.create_kubernetes_runtime(runtimeContext) # analogous to create_runtime()
  File "/usr/local/lib/python3.6/site-packages/calrissian/job.py", line 432, in create_kubernetes_runtime
    any_path_okay=True)
  File "/usr/local/lib/python3.6/site-packages/cwltool/job.py", line 575, in add_volumes
    runtime, vol, host_outdir_tgt, secret_store, tmpdir_prefix)
  File "/usr/local/lib/python3.6/site-packages/cwltool/job.py", line 537, in create_file_and_add_volume
    writable=writable)
  File "/usr/local/lib/python3.6/site-packages/calrissian/job.py", line 582, in append_volume
    raise NotImplementedError('append_volume')
NotImplementedError: append_volume
Workflow error, try again with --debug for more information:
append_volume

Test [82/108] Test expression in InitialWorkDir listing

Test [83/108] Test nameroot/nameext expression in arguments, stdout

Test [84/108] Test directory input with inputBinding

Test [85/108] Test command line generation of array-of-arrays

Test [86/108] Test $HOME and $TMPDIR are set correctly

Test [87/108] Test $HOME and $TMPDIR are set correctly in Docker

Test [88/108] Test that expressionLib requirement of individual tool step overrides expressionLib of workflow.

Test [89/108] Test output of InitialWorkDir

Test [90/108] Test embedded subworkflow

Test [91/108] Test secondaryFiles on array of files.

Test [92/108] Test directory literal output created by ExpressionTool

Test [93/108] Test file literal output created by ExpressionTool

Test [94/108] Test dockerOutputDirectory

Test [95/108] Test hints with $import

Test [96/108] Test warning instead of error when default path is not found

Test [97/108] Test InlineJavascriptRequirement with multiple expressions in the same tool

Test [98/108] Test if a writable input directory is recursivly copied and writable

Test [99/108] Test that missing parameters are null (not undefined) in expression

Test [100/108] Test that provided parameter is not null in expression

Test [101/108] Test compound workflow document

Test [102/108] Test that nameroot and nameext are generated from basename at execution time by the runner

Test [103/108] Test that file path in $(inputs) for initialworkdir is in $(outdir).

Test [104/108] Test single step workflow with Scatter step and two data links connected to
same input, flattened merge behavior. Workflow inputs are set as list


Test [105/108] Test step input with multiple sources with multiple types

Test [106/108] Test that shell directives are not interpreted.

Test [107/108] Test that shell directives are quoted.

Test [108/108] Test empty writable dir with InitialWorkDirRequirement

105 tests passed, 3 failures, 0 unsupported features

1 tool tests failed
